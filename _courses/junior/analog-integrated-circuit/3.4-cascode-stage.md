---
layout: article
title: Cascode Stage
permalink: /courses/junior/analog-integrated-circuit/cascode-stage
mathjax: true
mermaid: false
chart: false
mathjax_autoNumber: false
mode: normal
tags: æ¨¡æ‹Ÿé›†æˆç”µè·¯
key: 3.4-cascode-stage
nav_key: courses
show_edit_on_github: false
show_date: false
sidebar:
  nav: analog-integrated-circuit
aside:
  toc: true
---

<!--more-->

$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\tx}{\text}
\newcommand{\L}{\mathscr{L}}
\newcommand{\p}{\partial\,}
\end{align*}
$$

# Cascode Stage

å¦‚æœå°†ä¸¤ä¸ª MOS ç®¡æŒ‰ Fig. 3.59 é‚£æ ·è¿èµ·æ¥ï¼Œå°±æ˜¯ cascodeï¼ˆè¡¨ç¤º cascade triodesï¼‰ã€‚$M_1$ å— $V_\tx{in}$ è°ƒæ§äº§ç”Ÿç”µæµï¼Œæµç» $M_2$ åäº§ç”Ÿ $V_\tx{out}$

<center><img alt="Figure 3.59 Cascode stage" title="Figure 3.59 Cascode stage" src="assets/images/Figure%203.59%20Cascode%20stage.png" width="400"></center>

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ CS stage å’Œ CG stage çš„å…¬å¼ç®€ç•¥åˆ†æä¸€ä¸‹ã€‚å‡è®¾ä¸¤ç®¡éƒ½é¥±å’Œï¼Œå¹¶ä¸” $\lambda=\gamma=0$ï¼Œé‚£ä¹ˆï¼š

* å¯¹ $M_1$ æ¥è¯´ï¼Œè´Ÿè½½æ˜¯ä» $M_2$ æºç«¯çœ‹è¿›å»çš„ç”µé˜»ï¼Œæ•… $A_{v1}=-\dfrac{g_{m1}}{g_{m2}}$
* å¯¹ $M_2$ æ¥è¯´ï¼Œ$A_{v2}=g_{m1}R_D$

ä»è€Œæ€»çš„å¢ç›Šä¸ºï¼š$A_v = A_{v1}A_{v2}=-g_{m1}R_D$ï¼Œè¿™ä¸ªç»“æœå’Œ CS stage æ˜¯ä¸€æ ·çš„ï¼ˆFig. 3.60bï¼‰

<center><img alt="Figure 3.60 Cascode stage sensing a signal at the gate of (a) an input device and (b) a cascode device" title="Figure 3.60 Cascode stage sensing a signal at the gate of (a) an input device and (b) a cascode device" src="assets/images/Figure%203.60%20Cascode%20stage%20sensing%20a%20signal%20at%20the%20gate%20of%20(a)%20an%20input%20device%20and%20(b)%20a%20cascode%20device.png" width="400"></center>

æ³¨æ„åˆ°å¦‚æœ $M_1,M_2$ ä¸Šçš„ç”µæµç›¸ç­‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„åç½®å¿…é¡»æ»¡è¶³ä¸€å®šçš„è¦æ±‚ï¼Œå¹¶ä¸”è¾“å‡ºå¹…åº¦ä¹Ÿä¼šå—åç½®å½±å“ï¼Œå…·ä½“åˆ†æå¦‚ä¸‹ï¼š

<center><img alt="Figure 3.61 Allowable voltages in cascode stage" title="Figure 3.61 Allowable voltages in cascode stage" src="assets/images/Figure%203.61%20Allowable%20voltages%20in%20cascode%20stage.png" width="400"></center>


1. ä¸¤ç®¡å·¥ä½œåœ¨é¥±å’ŒåŒºï¼š
   * $V_\tx{in}>V_\tx{TH1}$ ä¸” $V_\tx{in}-V_\tx{TH1} \leq V_X$
   * $V_b-V_X>V_\tx{TH2}$ ä¸” $V_b-V_\tx{TH2} \leq V_\tx{out}$
2. ç”µå‹é—´æ»¡è¶³ä¸€å®šå…³ç³»ï¼š
   * $V_X=V_b-V_{GS2}$
   * $V_\tx{in}=V_{GS1}$

ä»è€Œï¼š

$$
\begin{aligned}
    V_\tx{out} &\geq V_\tx{in} - V_\tx{TH1}+V_{GS2}-V_\tx{TH2}\\
    &=(V_{GS1}-V_\tx{TH1})+(V_{GS2}-V_\tx{TH2})
\end{aligned}
$$

è¯´æ˜è¾“å‡ºç”µå‹çš„ä¸‹é™æ˜¯ä¸¤ç®¡ overdrive voltage ä¹‹å’Œã€‚

ä»¥ä¸Šåªæ˜¯é¥±å’ŒåŒºçš„æƒ…å†µï¼Œå®Œæ•´çš„ large-sianl behavior å¦‚ä¸‹ï¼ˆåˆ†æè¿‡ç¨‹ç•¥ï¼‰ï¼š

<center><img alt="Figure 3.62 Input-outputcharacteristic of a cascode stage" title="Figure 3.62 Input-outputcharacteristic of a cascode stage" src="assets/images/Figure%203.62%20Input-outputcharacteristic%20of%20a%20cascode%20stage.png" width="400"></center>

---

å°ä¿¡å·æ¨¡å‹å¦‚ä¸‹ï¼š

<center><img alt="Figure 3.63 Small-signal equivalent circuit of cascode stage" title="Figure 3.63 Small-signal equivalent circuit of cascode stage" src="assets/images/Figure%203.63%20Small-signal%20equivalent%20circuit%20of%20cascode%20stage.png" width="400"></center>

æ³¨æ„åˆ°è¾“å‡ºç«¯çš„ç”µæµåªèƒ½æ˜¯ $g_{m1}V_1$ï¼Œä»è€Œ $A_v = -g_{m1}R_D$ï¼Œä¸ $M_2$ æ— å…³ã€‚ä½†è¿™æ˜¯å¿½ç•¥äº† $M_1$ çš„ $r_{O1}$ çš„ç»“æœï¼ˆ$g_{mb1}$ å¿½ä¸å¿½ç•¥éƒ½ä¸€æ ·ï¼‰ï¼Œå¦‚æœè€ƒè™‘ä¸Šæ²Ÿé“é•¿åº¦è°ƒåˆ¶ï¼Œç»“æœä¼šä¸åŒã€‚å¦‚å›¾ Fig. 3.64ï¼Œ$r_O$ ä¼šèµ·åˆ°ä¸€ä¸ªåˆ†æµçš„ä½œç”¨ã€‚å› æ­¤ï¼š

$$
I_{D2} = g_{m1}V_\tx{in} \frac{g_{m2}+g_{mb2}}{\frac{1}{r_{O1}}+(g_{m2}+g_{mb2})}
$$

$(g_{m2}+g_{mb2})$ ä¸ºä» $M_2$ æºç«¯çœ‹è¿›å»çš„ç”µå¯¼ã€‚ä»è€Œå¢ç›Šä¸ºï¼š

$$
A_v = g_{m1} \frac{g_{m2}+g_{mb2}}{\frac{1}{r_{O1}}+(g_{m2}+g_{mb2})} R_D
$$

<center><img alt="Figure 3.64" title="Figure 3.64" src="assets/images/Figure%203.64.png" width="400"></center>

---

<center><img alt="Figure 3.65 Calculation of output resistance of cascode stage" title="Figure 3.65 Calculation of output resistance of cascode stage" src="assets/images/Figure%203.65%20Calculation%20of%20output%20resistance%20of%20cascode%20stage.png" width="400"></center>

ä¸‹é¢æ¥è®¡ç®—è¾“å‡ºç”µé˜»ã€‚æ³¨æ„åˆ° $M_1$ å¯ä»¥å½“ä½œæ˜¯ degeneration resister $r_{O1}$ï¼Œä»è€Œè¾“å‡ºç”µé˜»ä¸å‰é¢ï¼ˆCS Stage with Source Degenerationï¼‰çš„ä¸€æ ·ï¼š

$$
\begin{aligned}
    R_\tx{out} &= [1+(g_{m2}+g_{mb2})r_{O2}]r_{O1}+r_{O2}\\
    &\approx  (g_{m2}+g_{mb2})r_{O2}r_{O1}
\end{aligned}
$$

æ³¨æ„åˆ°è¾“å‡ºç”µé˜»å¯ä»¥çœ‹ä½œæ˜¯ $r_{O1}$ å¢å¤§äº† $(g_{m2}+g_{mb2})r_{O2}$ å€ï¼Œå¦‚æœçº§è”å¤šçº§ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¾ˆé«˜çš„è¾“å‡ºç”µé˜»ï¼ˆå½“ç„¶ï¼Œtrade off æ˜¯ç”µå‹æ‘†å¹…å‡å°ï¼‰

<center><img alt="Figure 3.66 Triple cascode" title="Figure 3.66 Triple cascode" src="assets/images/Figure%203.66%20Triple%20cascode.png" width="400"></center>

è¾“å‡ºé˜»æŠ—å¤§æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬è¦ä»‹ç» **Shielding Property**ï¼Œç”±äºè¾“å‡ºé˜»æŠ—å¤§ï¼Œå½“è¾“å‡ºç”µå‹å˜åŒ–æ—¶ï¼Œååº”åˆ°æºç«¯çš„ç”µå‹å˜åŒ–å°±ä¼šå°ã€‚æˆ‘ä»¬ç”¨ä¸‹é¢è¿™é‡Œä¾‹å­æ¥è¯´æ˜ã€‚

<p class="success">
$V_X$ is higher than $V_Y$ by $\Delta V$. Calculate the resulting difference between $I_{D1}$ and $I_{D2}$ if $Î»â‰ 0$.<br>
<center><img alt="Figure 3.72" title="Figure 3.72" src="assets/images/Figure%203.72.png" width="400"></center>
</p>

<p class="info">
(a) We have<br>

$$
\begin{aligned}
  I_{D1}-I_{D2} &= \frac{1}{2} \mu_n C_\tx{ox} \frac{W}{L} (V_b-V_\tx{TH})^2 (\lambda V_{DS1}-\lambda V_{DS2})\\
  &=\frac{1}{2} \mu_n C_\tx{ox} \frac{W}{L} (V_b - V_\tx{TH})^2 (\lambda \Delta V)
\end{aligned}
$$<br>

(b) Cascode èµ·åˆ°åˆ†å‹çš„ä½œç”¨<br>

$$
\begin{aligned}
  \Delta V_{PQ} &= \Delta V \frac{r_{O1}}{[1+(g_{m3}+g_{mb3})r_{O3}]r_{O1}+r_{O3}}\\
  &\approx \frac{\Delta V}{(g_{m3}+g_{mb3})r_{O3}}
\end{aligned}
$$<br>

Thus,<br>

$$
I_{D1}-I_{D2}=\frac{1}{2} \mu_n C_\tx{ox} \frac{W}{L} (V_b - V_\tx{TH})^2 \frac{\lambda \Delta V}{(g_{m3}+g_{mb3})r_{O3}}
$$<br>

In other words, cascoding reduces the mismatch between $I_{D1}$ and $I_{D2}$ by a factor of $(g_{m3} + g_{mb3})r_{O3}$.ï¼ˆä¸ªäººè§‰å¾—è¿™å°±æ˜¯ç®€å•çš„åŠ å¤§ç”µé˜»æ¥å‡å°ç”µæµå˜åŒ–ğŸ§ï¼‰
</p>

<p class="error">
<b>The shielding property of cascodes diminishes if the cascode device enters the triode region.</b> because <br>

$$
I_{D2}=\frac{1}{2}\mu_n C_\tx{ox} \left(\frac{W}{L}\right)_2\left[ 2(V_{b2}-V_P-V_\tx{TH2})(V_X-V_P)-(V_X-V_P)^2 \right]
$$<br>

As $V_X$ decreases, $V_P$ also drops, so that $I_{D2}$ remains constant.
</p>

ç”±äºè¿™ä¸ªç‰¹æ€§ååˆ†é‡è¦ï¼Œæˆ‘ä¸Šç½‘æœäº†äº›èµ„æ–™ï¼Œç„¶ååœ¨çŸ¥ä¹ä¸Šå‘ç°äº†ä¸€ç¯‡å¾ˆå¥½çš„æ–‡ç«  [æ¨¡æ‹Ÿç”µè·¯åŸºç¡€ä¹‹è¿æ”¾çš„å¢ç›Šè®¡ç®—ï¼ˆä¸‰ï¼‰cascode](https://zhuanlan.zhihu.com/p/20738454)ï¼Œé‡Œé¢æåˆ°ä¸€ç§å¾ˆæœ‰è¶£çš„ç†è§£æ–¹æ³•ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚

æˆ‘ä»¬è€ƒè™‘å…±æ …ç®¡çš„å°ä¿¡å·æ¨¡å‹ã€‚ç”±äº G æ˜¯æ¥æ’å‹æºï¼Œå¯çœ‹ä½œåœ°ï¼Œä»è€Œ $V_{GS}=-V_S$ï¼Œæ‰€ä»¥å›¾ä¸­ç”µæµæºæ–¹å‘æ˜¯åçš„ã€‚

<center><img alt="small signal model of cg stage in cascode stage" title="small signal model of cg stage in cascode stage" src="assets/images/small%20signal%20model%20of%20cg%20stage%20in%20cascode%20stage.jpg" width="400"></center>

æ ¹æ® KCLï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ•´ä¸ªç®¡çœ‹ä½œä¸€ä¸ªç»“ç‚¹ï¼Œåˆ™ $I_S=I_D$ï¼ˆæ­¤å¤„æŒ‡ç›´æµå¤§ä¿¡å·ï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ª $g_mV_S$ çš„ç”µæµï¼Œå…¶å®æ˜¯â€œè‡ªç”Ÿè‡ªç­â€çš„ï¼æ— è·¯å¯é€€çš„è¿™ä¸ª mos äººï¼Œåªå¥½æŠŠä¸€è‚šå­çš„æ€¨æ°”æ·±åŸ‹åœ¨å¿ƒåº•ï¼Œè‡ªå·±æ¶ˆåŒ–æ‰ã€‚

æ‰€ä»¥ï¼Œæµè¿‡ $r_O$ çš„ç”µæµï¼Œå°±æ˜¯åæ–¹å‘çš„ $g_mV_s$ï¼Œè¿™æ ·çœ‹æ¥ï¼Œè¿™ä¸ª mos ä¸Šçš„å‹é™ $V_{DS}$å°±ç­‰äº $r_og_mV_S$

å› æ­¤ï¼Œå½“æˆ‘ä»¬è®¡ç®— $V_D$ çš„ç”µå‹æ—¶ï¼Œæœ‰ï¼š

$$
\begin{aligned}
  V_D&=V_S+V_{DS}\\
  &=V_S+r_Og_mV_S\\
  &=(1+r_Og_m)V_S
\end{aligned}
$$

å› ä¸ºæˆ‘ä»¬çš„ $g_mr_O$ ä¸€èˆ¬èƒ½å¤Ÿè¾¾åˆ°ä¸€ç™¾ä»¥ä¸Šï¼Œæ‰€ä»¥ $V_D$ å°±å¤§çº¦ç­‰äº $g_mr_OV_S$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ª Golden Ruleï¼š**ä» s çœ‹åˆ° dï¼Œç”µå‹è¢«æ”¾å¤§äº† $g_mr_O$ å€ï¼›ä» d çœ‹åˆ° sï¼Œç”µå‹è¢«ç¼©å°äº† $g_mr_O$ å€ã€‚**ï¼ˆå‰æï¼šg æ¥æ’å‹æºä¸” mos å·¥ä½œåœ¨é¥±å’ŒåŒºï¼‰

# Folded Cascode

ä¹‹å‰ä¸¤ä¸ªéƒ½æ˜¯ NMOSï¼Œç°åœ¨æ˜¯ä¸€ä¸ª PMOS ç»™ NMOS æä¾›ç”µæµã€‚

<center><img alt="Figure 3.74 Simple folded cascode" title="Figure 3.74 Simple folded cascode" src="assets/images/Figure%203.74%20Simple%20folded%20cascode.png" width="400"></center>

$I_1$ ç”¨äºæä¾›ç›´æµåç½®ï¼Œæ˜¾ç„¶ $\vert I_{D1}\vert+I_{D2}=I_1$ï¼Œå¦‚æœ $I_{D1}$ å˜å°ï¼Œå°±ä¼šä½¿å¾— $I_{D2}$ å˜å¤§ï¼Œä»è€Œæ”¹å˜ $V_\tx{out}$

å¤§ä¿¡å·åˆ†æå¦‚ä¸‹ï¼š

* $V_\tx{in}>V_{DD}-\vert V_\tx{TH1} \vert$ï¼Œ$M_1$ is off and $M_2$ carries all of $I_1$. yielding $V_\tx{out}=V_{DD}-I_1R_D$
* $V_\tx{in}<V_{DD}-\vert V_\tx{TH1} \vert$, $M_1$ turns on in saturation, giving

$$
I_{D2}=I_1-\frac{1}{2}\mu_p C_\tx{ox} \left( \frac{W}{L} \right)_1 (V_{DD}-V_\tx{in}-\vert V_\tx{TH1} \vert)^2
$$

* $I_{D2}$ decrease further as $V_\tx{in}$ drops. If $I_{D2}=0$, $V_\tx{out}=V_{DD}$. The $V_\tx{in}$ at this point is denoted as $V_\tx{in1}$

$$
\frac{1}{2}\mu_p C_\tx{ox} \left( \frac{W}{L} \right)_1 (V_{DD}-V_\tx{in1}-\vert V_\tx{TH1} \vert)^2=I_1
$$

Thus,

$$
V_\tx{in1} = V_{DD}-\sqrt{\frac{2I_1}{\mu_p C_\tx{ox}(W/L)1}} - \vert V_\tx{TH1} \vert
$$

<center><img alt="Figure 3.75 Large-signal characteristics of folded cascode" title="Figure 3.75 Large-signal characteristics of folded cascode" src="assets/images/Figure%203.75%20Large-signal%20characteristics%20of%20folded%20cascode.png" width="400"></center>